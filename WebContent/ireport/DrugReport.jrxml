<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="DrugReport" language="groovy" pageWidth="595" pageHeight="842" columnWidth="535" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="fa2f3e9b-dc68-4ea3-930b-0f7fa9eccb1e">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Title" fontName="Times New Roman" fontSize="50" isBold="true" pdfFontName="Times-Bold"/>
	<style name="SubTitle" forecolor="#736343" fontName="Arial" fontSize="18"/>
	<style name="Column header" forecolor="#666666" fontName="Arial" fontSize="12" isBold="true"/>
	<style name="Detail" fontName="Arial" fontSize="12"/>
	<style name="Row" mode="Transparent">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{REPORT_COUNT}%2 == 0]]></conditionExpression>
			<style backcolor="#E6DAC3"/>
		</conditionalStyle>
	</style>
	<parameter name="BeginDate" class="java.lang.String"/>
	<parameter name="EndDate" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
     treatment.`treatment_date` AS treatment_treatment_date,
     drug.`drug_name` AS drug_drug_name,
     drug.`drug_price` AS drug_drug_price,
     treatment_drug.`drug_qty` AS treatment_drug_drug_qty,
     treatment_drug.`drug_sumprice` AS treatment_drug_drug_sumprice
FROM
     `treatment` treatment INNER JOIN `treatment_drug` treatment_drug ON treatment.`id` = treatment_drug.`refer_treatment_id`
     INNER JOIN `drug` drug ON treatment_drug.`refer_drug_id` = drug.`id`
WHERE
     treatment.`treatment_date` BETWEEN $P{BeginDate}AND$P{EndDate}]]>
	</queryString>
	<field name="treatment_treatment_date" class="java.lang.String"/>
	<field name="drug_drug_name" class="java.lang.String"/>
	<field name="drug_drug_price" class="java.math.BigDecimal"/>
	<field name="treatment_drug_drug_qty" class="java.lang.Integer"/>
	<field name="treatment_drug_drug_sumprice" class="java.math.BigDecimal"/>
	<variable name="total" class="java.math.BigDecimal" incrementType="Group" incrementGroup="groupRecord" calculation="Sum">
		<variableExpression><![CDATA[$F{treatment_drug_drug_sumprice}]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<variable name="recordGroup" class="java.math.BigDecimal" resetType="Group" resetGroup="DateGroup" incrementType="Group" incrementGroup="groupRecord" calculation="Sum">
		<variableExpression><![CDATA[$F{treatment_drug_drug_sumprice}]]></variableExpression>
	</variable>
	<group name="DateGroup">
		<groupExpression><![CDATA[$F{treatment_treatment_date}]]></groupExpression>
		<groupFooter>
			<band height="25">
				<textField>
					<reportElement x="520" y="2" width="55" height="20" uuid="a928e7b8-2768-49db-9c77-bc03ac15f2ca"/>
					<textFieldExpression><![CDATA[new java.text.DecimalFormat("#,###.00").format($V{recordGroup})]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement style="Column header" x="442" y="0" width="76" height="16" forecolor="#736343" uuid="f481bdfb-9edd-44c9-aaf9-98176c14e095"/>
					<textElement textAlignment="Right">
						<font fontName="TH SarabunPSK" size="14"/>
					</textElement>
					<text><![CDATA[รวมราคาต่อวัน]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<group name="groupRecord">
		<groupExpression><![CDATA[$V{DateGroup_COUNT}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="136" splitType="Stretch">
			<staticText>
				<reportElement style="Title" x="169" y="20" width="263" height="62" uuid="a28dc95c-df68-4557-93b5-ca2681ee6454"/>
				<textElement verticalAlignment="Middle">
					<font fontName="TH SarabunPSK" size="24" pdfFontName="Times-Roman"/>
				</textElement>
				<text><![CDATA[รายงานสรุปการรับชำระเงินค่ายา]]></text>
			</staticText>
			<textField pattern="EEEEE dd MMMMM yyyy">
				<reportElement style="Column header" x="230" y="0" width="107" height="20" forecolor="#736343" uuid="9a3e2fbd-7512-42e9-bc9c-a00fde186b6c"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="Column header" x="432" y="0" width="80" height="20" forecolor="#736343" uuid="4388b60c-daec-4228-90aa-fb1533dae24d"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement style="Column header" x="515" y="0" width="40" height="20" forecolor="#736343" uuid="a648a79d-af40-4b82-bea9-620dc89ccb94"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="1" y="0" width="143" height="136" uuid="96ed5aa5-563e-4afe-8c63-ec11644fa5bd"/>
				<imageExpression><![CDATA["D:\\JavaProject\\clinic_web\\WebContent\\ireport\\1.png"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="242" y="95" width="78" height="14" uuid="dcd54e64-1df0-470b-a7c3-113ce9688b03"/>
				<textFieldExpression><![CDATA[$P{BeginDate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="325" y="95" width="63" height="14" uuid="ae65d7d2-d49d-4c96-ab46-dc33749a48f2"/>
				<textFieldExpression><![CDATA[$P{EndDate}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="Column header" x="181" y="93" width="61" height="16" forecolor="#736343" uuid="b7f59d31-d908-462f-ae3a-7180471858c0"/>
				<textElement>
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ระหว่างวันที่]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="304" y="93" width="16" height="16" forecolor="#736343" uuid="92276941-54ec-47f1-a536-52090768bb32"/>
				<textElement>
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ถึง]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="16" splitType="Stretch">
			<line>
				<reportElement positionType="FixRelativeToBottom" x="0" y="15" width="555" height="1" uuid="1b22fc82-9215-4383-a875-aa2d8b162e8d"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement style="Column header" x="1" y="0" width="68" height="16" forecolor="#736343" uuid="cdba55be-2623-4dc2-9103-e0560ef224e4"/>
				<textElement>
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[วันที่]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="69" y="0" width="215" height="16" forecolor="#736343" uuid="af5b6420-8fb0-46b2-a74b-c29f5537bd3e"/>
				<textElement>
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ชื่อยา]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="397" y="0" width="76" height="16" forecolor="#736343" uuid="c06788df-2010-4904-aad8-4dceb6484046"/>
				<textElement textAlignment="Right">
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[จำนวน]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="473" y="0" width="82" height="16" forecolor="#736343" uuid="2f161ac3-c378-4761-9121-1e7053cabaa9"/>
				<textElement textAlignment="Right">
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ราคารวม]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="284" y="0" width="113" height="16" forecolor="#736343" uuid="80ef77cb-f4c9-4682-9d9a-b7f94662c233"/>
				<textElement textAlignment="Right">
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ราคายาต่อหน่วย]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="16" splitType="Stretch">
			<frame>
				<reportElement style="Row" mode="Opaque" x="0" y="0" width="555" height="15" uuid="25c31d94-03ee-408d-9e04-049e315e26ce"/>
				<textField isStretchWithOverflow="true">
					<reportElement style="Detail" x="0" y="0" width="69" height="15" uuid="fea8f8cd-141b-4631-adff-2122f7d48717"/>
					<textElement>
						<font fontName="TH SarabunPSK" size="12"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{treatment_treatment_date}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true">
					<reportElement style="Detail" x="69" y="0" width="215" height="15" uuid="7bd0a55d-c397-4e91-b7eb-751a59d8bc2b"/>
					<textElement>
						<font fontName="TH SarabunPSK"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{drug_drug_name}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true">
					<reportElement style="Detail" x="397" y="0" width="76" height="15" uuid="b5f0c791-9ef9-47ae-bdad-aec8b449bf05"/>
					<textElement textAlignment="Right">
						<font fontName="TH SarabunPSK"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{treatment_drug_drug_qty}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true">
					<reportElement style="Detail" x="473" y="0" width="82" height="15" uuid="f42b229e-95cb-4509-95b5-ba78ceaeb7a3"/>
					<textElement textAlignment="Right">
						<font fontName="TH SarabunPSK"/>
					</textElement>
					<textFieldExpression><![CDATA[new java.text.DecimalFormat("#,###.00").format($F{treatment_drug_drug_sumprice})]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true">
					<reportElement style="Detail" x="284" y="0" width="113" height="15" uuid="19737ba8-b50c-456d-ae74-2daa55376c00"/>
					<textElement textAlignment="Right">
						<font fontName="TH SarabunPSK"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{drug_drug_price}]]></textFieldExpression>
				</textField>
			</frame>
		</band>
	</detail>
	<lastPageFooter>
		<band height="96">
			<staticText>
				<reportElement x="327" y="41" width="228" height="20" uuid="aca38100-920c-4971-9d52-5a4f7b6b00c7"/>
				<textElement>
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[(ลงชื่อ)_________________________________]]></text>
			</staticText>
			<staticText>
				<reportElement x="376" y="61" width="100" height="20" uuid="7f740834-66d1-4f87-8300-ccfcd1095227"/>
				<textElement textAlignment="Center">
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ผู้ตรวจสอบ]]></text>
			</staticText>
			<staticText>
				<reportElement x="44" y="61" width="100" height="20" uuid="c74f3405-bd63-45b4-9e5f-269b8488dcf4"/>
				<textElement textAlignment="Center">
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[ผู้จัดทำ]]></text>
			</staticText>
			<staticText>
				<reportElement x="6" y="41" width="195" height="20" uuid="188a45af-10bf-4c66-a659-69d45afbb655"/>
				<textElement>
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[(ลงชื่อ)_____________________________]]></text>
			</staticText>
			<staticText>
				<reportElement style="Column header" x="442" y="0" width="76" height="16" forecolor="#736343" uuid="db21b90c-9409-41cb-a6c9-b89adda9b29e"/>
				<textElement textAlignment="Right">
					<font fontName="TH SarabunPSK" size="14"/>
				</textElement>
				<text><![CDATA[รวมราคาทั้งหมด]]></text>
			</staticText>
			<textField>
				<reportElement x="520" y="3" width="79" height="20" uuid="3b5982d8-558a-4003-9898-6b3d08b4f20a"/>
				<textFieldExpression><![CDATA[new java.text.DecimalFormat("#,###.00").format($V{total})]]></textFieldExpression>
			</textField>
		</band>
	</lastPageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
